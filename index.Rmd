---
title: "Plot"
author: "José Tiago"
date: "2023-09-01"
output: html_document
---
```{r}
library(tidyverse)
index1 = read.csv("IndexSelBayesPeso1.csv")
target = index1[c(1:32, which(index1$ID.p == "Pérola_391"),which(index1$ID.p == "Madrepérola_386"), which(index1$ID.p == "VC25_382"),which(index1$ID.p == "Uai_400")) ,1] ;
load("a.rda")
MeanProd = read.table("MeanProds.txt", stringsAsFactors = F)

a = rbind(a,data.frame(x = sort(unique(MeanProd$Families)), y = sort(unique(MeanProd$Families)), prob = NA));
a <- a %>% arrange(x,y)

length(target)
a = a %>% filter(x %in% target & y %in% target) #%>% filter ()
dim(a) 

c = a %>% pivot_wider(values_from = prob, names_from = x, names_sort = T) %>% column_to_rownames('y'); dim(c) 

dim(c)
load("b.rda")
MeanAG = read.table("MeanAGs.txt")
b = rbind(b,data.frame(x = sort(unique(MeanAG$Families)), y = sort(unique(MeanAG$Families)), prob = NA));dim(b)
b <- b %>% arrange(x,y)
b = b %>% filter(x %in%  target & y %in% target) #%>% filter ()
dim(b)

d = b %>% pivot_wider(values_from = prob, names_from = x, names_sort = T) %>% 
  column_to_rownames('y')
dim(d)




c[lower.tri(c)] 
d[lower.tri(d)]

e=c
#new <- matrix(NA, nrow = 36, ncol = 36)
e[upper.tri(e)] <-d[lower.tri(d)]
#new[lower.tri(new)] <-c[lower.tri(c)]
#new = as.matrix(new)
#c[lower.tri(c)] = d[upper.tri(d)]
mat = e

x_lab <- " Pairwise Prob. Grain Yield"
y_lab <- " Pairwise Prob. Grain Quality"
x_title <- "Pairwise probability of superior performance Grain Yield and Grain Quality" 

dim(mat)

p=mat %>% rownames_to_column(var = 'x') %>% 
  pivot_longer(cols = c(colnames(mat)[1]:colnames(mat)[length(colnames(mat))])) %>% 
  rename('y' = name) %>% 
  ggplot(aes(x = x, y = y))+
  geom_tile(aes(fill = value), colour = 'white')+ 
  theme(axis.title.x = element_text(size = 11, face = "bold", color = "black"),
        axis.title.y = element_text(size = 11, face = "bold", color = "black"),
        axis.text.x  = element_text(size = 8, face = "bold", color = "black"),
        axis.text.y  = element_text(size = 8, face = "bold", color = "black")) +
  labs(x = x_lab, y = y_lab, fill = "Pr")+
  theme(axis.text.x = element_text(angle = 90),panel.background = element_blank(),
        legend.position = 'right', legend.direction = 'vertical')+
  coord_flip()+
  scale_fill_viridis_c(direction = -1, na.value = 'white',limits = c(0,1))

ggsave(plot = p, filename = "PropConjProdAG.pdf", device = "pdf", scale = 1, dpi = "retina")

plot(p)
```
